# HOWARD Calculation configuration

## Calculations Configuration Guide

Calculation processes variants annotations to generate new annotation, such as: identify variation type (VarType), harmonizes allele frequency (VAF) and calculate statistics (VAF_stats), extracts Nomen (transcript, cNomen, pNomen...) from an HGVS field (e.g. snpEff, Annovar) with an optional list of personalized transcripts, generates VaRank format barcode, identify trio inheritance. These calculations are based on existing annotations of variants (and genotypes).

See [HOWARD Help Calculation tool](help.md#calculation-tool) tool for more information.

Calculations are either provided by HOWARD within code, or configured into a JSON file with specific fields to define how to calculate the new annotation. Calculations are either an inner HOWARD Python code, or a SQL query.

## Example

```json
{
	"VARTYPE": {
		"type": "sql",
		"name": "VARTYPE",
		"description": "Variant type (e.g. SNV, INDEL, MNV, BND...)",
		"available": true,
		"output_column_name": "VARTYPE",
		"output_column_type": "String",
		"output_column_description": "Variant type: SNV if X>Y, MOSAIC if X>Y,Z or X,Y>Z, INDEL if XY>Z or X>YZ",
		"operation_query": [
			"CASE",
			"WHEN \"SVTYPE\" NOT NULL THEN \"SVTYPE\"",
			"WHEN LENGTH(REF) = 1 AND LENGTH(ALT) = 1 THEN 'SNV'",
			"WHEN REF LIKE '%,%' OR ALT LIKE '%,%' THEN 'MOSAIC'",
			"WHEN LENGTH(REF) == LENGTH(ALT) AND LENGTH(REF) 1 THEN 'MNV'",
			"WHEN LENGTH(REF) <LENGTH(ALT) THEN 'INDEL'",
			"ELSE 'UNDEFINED'",
			"END"
		],
		"info_fields": ["SVTYPE"],
		"operation_info": true
	},
	"variant_id": {
		"type": "python",
		"name": "variant_id",
		"description": "Variant ID generated from variant position and type",
		"available": true,
		"function_name": "calculation_variant_id",
		"function_params": []
	}
}
```

## Calculation fields explanation

### type 
  - *Type:* String
  - *Description:* Indicates the type of calculation. It can be either 'sql' for a SQL query or 'function' for a Python function.

### name 
  - *Type:* String
  - *Description:* Represents the unique name assigned to the calculation.

### description 
  - *Type:* String
  - *Description:* Provides a brief description of the calculation, explaining its purpose or what it calculates.

### available
  - *Type:* Boolean
  - *Description:* Specifies whether the calculation is available and enabled for use. If set to true, it's available; otherwise, it's not accessible.

### output_column_name
  - *Type:* String
  - *Description:* Specifies the output column and VCF INFO/Tag generated by the calculation.

### output_column_type
  - *Type:* String
  - *Description:* Specifies the VCF INFO/Tag type of the output column generated by the calculation (e.g., String, Integer, Float).

### output_column_description
  - *Type:* String
  - *Description:* Provides a detailed description of the the VCF INFO/Tag, explaining its content, format, or how it's derived.

### operation_query
  - *Type:* Array of Strings
  - *Description:* For SQL type calculations, this field contains the SQL query used to perform the calculation. It consists of SQL statements that define the logic of the calculation. SQL columns need to be available for the query (see 'info_fields')

### info_fields
  - *Type:* Array of Strings
  - *Description:* Specifies additional input fields or columns required by the calculation. These fields are used as parameters or conditions in the calculation process (especially SQL query).

### operation_info
  - *Type:* Boolean
  - *Description:* Indicates whether additional information (specified in 'info_fields') is necessary for performing the calculation. If set to true, the additional information is required, the INFO/tag need to be in the VCF header; otherwise, it's optional.

### function_name
  - *Type:* String
  - *Description:* For Python type calculations, this field specifies the name of the Python function used to perform the calculation.

### function_params
  - *Type:* Array of Strings
  - *Description:* For Python type calculations, specifies any additional parameters required by the Python function specified in 'function_name'.
