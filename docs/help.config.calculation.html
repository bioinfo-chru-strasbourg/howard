<!DOCTYPE html>
<html>
<head>
<title>help.config.calculation.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/*

github.com style (c) Vasily Polovnyov <vast@whiteants.net>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #333;
  background: #f8f8f8;
}

.hljs-comment,
.hljs-quote {
  color: #998;
  font-style: italic;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-subst {
  color: #333;
  font-weight: bold;
}

.hljs-number,
.hljs-literal,
.hljs-variable,
.hljs-template-variable,
.hljs-tag .hljs-attr {
  color: #008080;
}

.hljs-string,
.hljs-doctag {
  color: #d14;
}

.hljs-title,
.hljs-section,
.hljs-selector-id {
  color: #900;
  font-weight: bold;
}

.hljs-subst {
  font-weight: normal;
}

.hljs-type,
.hljs-class .hljs-title {
  color: #458;
  font-weight: bold;
}

.hljs-tag,
.hljs-name,
.hljs-attribute {
  color: #000080;
  font-weight: normal;
}

.hljs-regexp,
.hljs-link {
  color: #009926;
}

.hljs-symbol,
.hljs-bullet {
  color: #990073;
}

.hljs-built_in,
.hljs-builtin-name {
  color: #0086b3;
}

.hljs-meta {
  color: #999;
  font-weight: bold;
}

.hljs-deletion {
  background: #fdd;
}

.hljs-addition {
  background: #dfd;
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}

</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="howard-calculation-configuration">HOWARD Calculation configuration</h1>
<h2 id="calculations-configuration-guide">Calculations Configuration Guide</h2>
<p>Calculation processes variants annotations to generate new annotation, such as: identify variation type (VarType), harmonizes allele frequency (VAF) and calculate statistics (VAF_stats), extracts Nomen (transcript, cNomen, pNomen...) from an HGVS field (e.g. snpEff, Annovar) with an optional list of personalized transcripts, generates VaRank format barcode, identify trio inheritance. These calculations are based on existing annotations of variants (and genotypes).</p>
<p>See <a href="help.md#calculation-tool">HOWARD Help Calculation tool</a> tool for more information.</p>
<p>Calculations are either provided by HOWARD within code, or configured into a JSON file with specific fields to define how to calculate the new annotation. Calculations are either an inner HOWARD Python code, or a SQL query.</p>
<h2 id="example">Example</h2>
<pre class="hljs"><code><div>{
	<span class="hljs-attr">"VARTYPE"</span>: {
		<span class="hljs-attr">"type"</span>: <span class="hljs-string">"sql"</span>,
		<span class="hljs-attr">"name"</span>: <span class="hljs-string">"VARTYPE"</span>,
		<span class="hljs-attr">"description"</span>: <span class="hljs-string">"Variant type (e.g. SNV, INDEL, MNV, BND...)"</span>,
		<span class="hljs-attr">"available"</span>: <span class="hljs-literal">true</span>,
		<span class="hljs-attr">"output_column_name"</span>: <span class="hljs-string">"VARTYPE"</span>,
		<span class="hljs-attr">"output_column_type"</span>: <span class="hljs-string">"String"</span>,
		<span class="hljs-attr">"output_column_description"</span>: <span class="hljs-string">"Variant type: SNV if X&gt;Y, MOSAIC if X&gt;Y,Z or X,Y&gt;Z, INDEL if XY&gt;Z or X&gt;YZ"</span>,
		<span class="hljs-attr">"operation_query"</span>: [
			<span class="hljs-string">"CASE"</span>,
			<span class="hljs-string">"WHEN \"SVTYPE\" NOT NULL THEN \"SVTYPE\""</span>,
			<span class="hljs-string">"WHEN LENGTH(REF) = 1 AND LENGTH(ALT) = 1 THEN 'SNV'"</span>,
			<span class="hljs-string">"WHEN REF LIKE '%,%' OR ALT LIKE '%,%' THEN 'MOSAIC'"</span>,
			<span class="hljs-string">"WHEN LENGTH(REF) == LENGTH(ALT) AND LENGTH(REF) 1 THEN 'MNV'"</span>,
			<span class="hljs-string">"WHEN LENGTH(REF) &lt;LENGTH(ALT) THEN 'INDEL'"</span>,
			<span class="hljs-string">"ELSE 'UNDEFINED'"</span>,
			<span class="hljs-string">"END"</span>
		],
		<span class="hljs-attr">"info_fields"</span>: [<span class="hljs-string">"SVTYPE"</span>],
		<span class="hljs-attr">"operation_info"</span>: <span class="hljs-literal">true</span>
	},
	<span class="hljs-attr">"variant_id"</span>: {
		<span class="hljs-attr">"type"</span>: <span class="hljs-string">"python"</span>,
		<span class="hljs-attr">"name"</span>: <span class="hljs-string">"variant_id"</span>,
		<span class="hljs-attr">"description"</span>: <span class="hljs-string">"Variant ID generated from variant position and type"</span>,
		<span class="hljs-attr">"available"</span>: <span class="hljs-literal">true</span>,
		<span class="hljs-attr">"function_name"</span>: <span class="hljs-string">"calculation_variant_id"</span>,
		<span class="hljs-attr">"function_params"</span>: []
	}
}
</div></code></pre>
<h2 id="calculation-fields-explanation">Calculation fields explanation</h2>
<h3 id="type">type</h3>
<ul>
<li><em>Type:</em> String</li>
<li><em>Description:</em> Indicates the type of calculation. It can be either 'sql' for a SQL query or 'function' for a Python function.</li>
</ul>
<h3 id="name">name</h3>
<ul>
<li><em>Type:</em> String</li>
<li><em>Description:</em> Represents the unique name assigned to the calculation.</li>
</ul>
<h3 id="description">description</h3>
<ul>
<li><em>Type:</em> String</li>
<li><em>Description:</em> Provides a brief description of the calculation, explaining its purpose or what it calculates.</li>
</ul>
<h3 id="available">available</h3>
<ul>
<li><em>Type:</em> Boolean</li>
<li><em>Description:</em> Specifies whether the calculation is available and enabled for use. If set to true, it's available; otherwise, it's not accessible.</li>
</ul>
<h3 id="outputcolumnname">output_column_name</h3>
<ul>
<li><em>Type:</em> String</li>
<li><em>Description:</em> Specifies the output column and VCF INFO/Tag generated by the calculation.</li>
</ul>
<h3 id="outputcolumntype">output_column_type</h3>
<ul>
<li><em>Type:</em> String</li>
<li><em>Description:</em> Specifies the VCF INFO/Tag type of the output column generated by the calculation (e.g., String, Integer, Float).</li>
</ul>
<h3 id="outputcolumndescription">output_column_description</h3>
<ul>
<li><em>Type:</em> String</li>
<li><em>Description:</em> Provides a detailed description of the the VCF INFO/Tag, explaining its content, format, or how it's derived.</li>
</ul>
<h3 id="operationquery">operation_query</h3>
<ul>
<li><em>Type:</em> Array of Strings</li>
<li><em>Description:</em> For SQL type calculations, this field contains the SQL query used to perform the calculation. It consists of SQL statements that define the logic of the calculation. SQL columns need to be available for the query (see 'info_fields')</li>
</ul>
<h3 id="infofields">info_fields</h3>
<ul>
<li><em>Type:</em> Array of Strings</li>
<li><em>Description:</em> Specifies additional input fields or columns required by the calculation. These fields are used as parameters or conditions in the calculation process (especially SQL query).</li>
</ul>
<h3 id="operationinfo">operation_info</h3>
<ul>
<li><em>Type:</em> Boolean</li>
<li><em>Description:</em> Indicates whether additional information (specified in 'info_fields') is necessary for performing the calculation. If set to true, the additional information is required, the INFO/tag need to be in the VCF header; otherwise, it's optional.</li>
</ul>
<h3 id="functionname">function_name</h3>
<ul>
<li><em>Type:</em> String</li>
<li><em>Description:</em> For Python type calculations, this field specifies the name of the Python function used to perform the calculation.</li>
</ul>
<h3 id="functionparams">function_params</h3>
<ul>
<li><em>Type:</em> Array of Strings</li>
<li><em>Description:</em> For Python type calculations, specifies any additional parameters required by the Python function specified in 'function_name'.</li>
</ul>

</body>
</html>
